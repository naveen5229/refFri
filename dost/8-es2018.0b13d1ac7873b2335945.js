(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{Kkpf:function(e,t,n){"use strict";n.r(t),n.d(t,"BatteryModule",(function(){return P}));var a=n("iInd"),r=n("OlR4"),o=n("H+bZ"),i=n("Xy1B"),l=n("qfBg"),s=n("8Y7J"),d=n("G0yt"),m=n("tKwJ"),c=n("SVse"),h=n("s7LF"),u=n("0zba"),p=n("wD9S");function g(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"td"),s["\u0275\u0275elementStart"](1,"button",31),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](3).addMore()})),s["\u0275\u0275element"](2,"i",32),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}}function v(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"td"),s["\u0275\u0275elementStart"](1,"button",33),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](e);const t=s["\u0275\u0275nextContext"]().index;return s["\u0275\u0275nextContext"](2).inventories.splice(t,1)})),s["\u0275\u0275element"](2,"i",34),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}}function y(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td",23),s["\u0275\u0275elementStart"](4,"auto-suggestion",24),s["\u0275\u0275listener"]("onSelected",(function(n){s["\u0275\u0275restoreView"](e);const a=t.index;return s["\u0275\u0275nextContext"](2).selectModel(n,a)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"td",25),s["\u0275\u0275elementStart"](6,"input",26),s["\u0275\u0275listener"]("ngModelChange",(function(n){return s["\u0275\u0275restoreView"](e),t.$implicit.batteryNo=n}))("focus",(function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"](2).size(n)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"td",27),s["\u0275\u0275elementStart"](8,"input",28),s["\u0275\u0275listener"]("ngModelChange",(function(n){return s["\u0275\u0275restoreView"](e),t.$implicit.months=n})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"td",27),s["\u0275\u0275elementStart"](10,"input",29),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"](2).getDate(n)})),s["\u0275\u0275pipe"](11,"date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](12,g,3,0,"td",30),s["\u0275\u0275template"](13,v,3,0,"td",30),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](n+1),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("inputId","modelNo_"+n),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngModel",e.batteryNo),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngModel",e.months),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("value",s["\u0275\u0275pipeBind2"](11,7,e.buydate,"dd MMM yyyy")),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngIf",0==n),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",0!==n)}}function f(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"table",19),s["\u0275\u0275elementStart"](1,"thead",20),s["\u0275\u0275elementStart"](2,"tr",21),s["\u0275\u0275elementStart"](3,"th"),s["\u0275\u0275text"](4,"# "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](5,"th"),s["\u0275\u0275text"](6,"Battery Model"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](7,"th"),s["\u0275\u0275text"](8,"Battery No"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"th"),s["\u0275\u0275text"](10,"Warrenty Month "),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](11,"th"),s["\u0275\u0275text"](12,"Purchase Date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"th"),s["\u0275\u0275text"](14,"\xa0"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](15,"tbody"),s["\u0275\u0275template"](16,y,14,10,"tr",22),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](16),s["\u0275\u0275property"]("ngForOf",e.inventories)}}function b(e,t){if(1&e&&s["\u0275\u0275element"](0,"smart-table",35),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275property"]("data",e.table.data)("settings",e.table.settings)}}function S(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",36),s["\u0275\u0275elementStart"](1,"h4",37),s["\u0275\u0275text"](2,"No Record Found"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]())}let E=(()=>{class e{constructor(e,t,n,a){let r;this.modalService=e,this.common=t,this.api=n,this.user=a,this.csv=null,this.startDate="",this.endDate="",this.mapped=-1,this.data=[],this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={},this.inventories=[{modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)},{modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)},{modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)}],this.activeRow=-1,this.modelSuggestion=!1,this.models=[],this.sizeSuggestion=[],this.userType=null,console.log("user",a._loggedInBy),this.userType=this.common.user._loggedInBy,r=new Date,this.endDate=this.common.dateFormatter(r),this.startDate=this.common.dateFormatter(new Date(r.setDate(r.getDate()-7))),console.log("dates ",this.endDate,this.startDate),this.getBatteries(),this.common.refresh=this.refresh.bind(this)}ngOnInit(){}refresh(){this.getBatteries()}searchModels(e,t){this.modelSuggestion=!0;let n="search="+e+"&typeId=-2";console.log("params",n),this.activeRow=t,e.length>2&&setTimeout(()=>{console.log("length=",e.length),console.log("parmas",n),this.api.get("Suggestion/getBatteryNamesWithBrands?"+n).subscribe(e=>{this.models=e.data,console.log("suggestions",this.models)},e=>{console.error(e),this.common.showError()})},3e3)}selectModel(e,t){console.log("model",e),this.inventories[t].modelId=""+e.item_id,this.inventories[t].months=e.max_limit,this.modelSuggestion=!1}testFilledData(){let e=this.inventories.length,t=[];for(let n=0;n<e;n++){if(console.log("batteryno.",this.inventories[n].batteryNo),null==this.inventories[n].batteryNo&&null!=this.inventories[n].modelId)return void this.common.showToast("fill battery number to continue");if(null!=this.inventories[n].batteryNo&&null!=this.inventories[n].modelId){if(this.inventories[n].months&&this.inventories[n].months>99)return void this.common.showToast("warrenty month can not be exceeded 99");t.push(this.inventories[n])}}console.log("inv",t),this.inventories=t;for(let n=0;n<this.inventories.length;n++)this.inventories[n].buydate=this.common.dateFormatter(new Date(this.inventories[n].buydate)).split(" ")[0];this.saveDetails()}getDate(e){this.common.params={ref_page:"Inventory"},this.modalService.open(i.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then(t=>{this.inventories[e].buydate=this.common.dateFormatter(t.date).split(" ")[0],console.log("Date:",this.inventories[e].buydate)})}size(e){console.log("size-"+e),this.inventories[e].batteryNo=document.getElementById("size-"+e).value}saveDetails(){console.log("inventories",this.inventories),this.common.loading++;let e={batterydetails:JSON.stringify(this.inventories)};console.log("Params:",e),this.api.post("Battery/saveBatteryInventory",e).subscribe(e=>{this.common.loading--,console.log("return id ",e.data[0].r_id),e.data[0].r_id>0?this.common.showToast("sucess"):(this.common.showError(e.data[0].r_msg),this.addMore())},e=>{this.common.loading--,console.error(e),this.common.showError()})}getDate2(e){this.common.params={ref_page:"LrView"},this.modalService.open(i.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then(t=>{if(t.date){if("start"==e)return this.startDate="",this.startDate=this.common.dateFormatter1(t.date).split(" ")[0];this.endDate=this.common.dateFormatter1(t.date).split(" ")[0],console.log("endDate",this.endDate)}})}getBatteries(){var e=new Date(this.common.dateFormatter1(this.endDate).split(" ")[0]);let t={startDate:this.common.dateFormatter1(this.startDate).split(" ")[0],endDate:this.common.dateFormatter1(e.setDate(e.getDate()+1)).split(" ")[0],mapped:this.mapped};++this.common.loading,this.api.post("Battery/getBatteryInventory",t).subscribe(e=>{--this.common.loading,this.data=e.data,this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={};let t=this.data[0];for(var n in t)if("_"!=n.charAt(0)){this.headings.push(n);let e={title:this.formatTitle(n),placeholder:this.formatTitle(n)};this.table.data.headings[n]=e}this.table.data.columns=this.getTableColumns()},e=>{--this.common.loading,console.log("Err:",e)})}formatTitle(e){return e.charAt(0).toUpperCase()+e.slice(1)}getTableColumns(){let e=[];return console.log("Data=",this.data),this.data.map(t=>{this.valobj={};for(let e=0;e<this.headings.length;e++)this.valobj[this.headings[e]]={value:t[this.headings[e]],class:"black",action:""};e.push(this.valobj)}),e}addMore(){this.inventories.push({modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)})}remove(){this.inventories.pop()}handleFileSelection(e){this.common.loading++,this.common.getBase64(e.target.files[0]).then(t=>{if(this.common.loading--,"text/csv"!=e.target.files[0].type)return alert("valid Format Are : CSV"),!1;t=t.toString().replace("vnd.ms-excel","csv"),console.log("Base 64: ",t),this.csv=t},e=>{this.common.loading--,console.error("Base Err: ",e)})}importCsv(){const e={inventoryCsv:this.csv};if(!e.inventoryCsv)return this.common.showError("Select csv");console.log("Data :",e),this.common.loading++,this.api.post("Tyres/importTyreInventoryCsv ",e).subscribe(e=>{this.common.loading--,console.log("upload result",e),console.log("error: ",e.data.f),alert(e.msg)},e=>{this.common.loading--,console.log(e)})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](d.r),s["\u0275\u0275directiveInject"](r.a),s["\u0275\u0275directiveInject"](o.a),s["\u0275\u0275directiveInject"](l.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["battery-inventory"]],decls:34,vars:12,consts:[[2,"border","0px"],[1,"row"],[1,"col-sm-8"],["class","table table-bordered table-hover",4,"ngIf"],[1,"row-width","clearfix"],[1,"text-left"],["type","button","outline","","id","saveDetails",1,"btn","btn-primary",2,"cursor","pointer",3,"click"],[1,"row","mt-3"],[1,"col-sm-3"],[1,"form","Control",3,"ngModel","ngModelChange"],["value","-1"],["value","1"],["value","0"],["type","text","name","date","placeholder","Start Date",1,"form-control",3,"value","click"],["type","text","name","date1","placeholder","End Date",1,"form-control",3,"value","click"],[1,"btn","btn-primary",3,"click"],[1,"mt-3"],[3,"data","settings",4,"ngIf"],["class","alert alert-danger text-center mt-3","style","margin-top:4rem",4,"ngIf"],[1,"table","table-bordered","table-hover"],[1,"thead"],[2,"text-align","center"],[4,"ngFor","ngForOf"],["width","35%"],["url","Suggestion/getBatteryNamesWithBrands?typeId=-2","display","modelname","placeholder","Model No",3,"inputId","onSelected"],["width","15%"],["id","battNo","name","battNo","type","text","placeholder","Enter battery number","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange","focus"],["width","20%"],["type","text","autocomplete","off","placeholder","Warrenty Month","name","date",1,"form-control",2,"cursor","pointer",3,"ngModel","ngModelChange"],["type","text","autocomplete","off","placeholder","Select Date","name","date","readonly","",1,"form-control",2,"cursor","pointer",3,"value","click"],[4,"ngIf"],[1,"btn","btn-primary","add",3,"click"],[1,"fa","fa-plus"],[1,"btn","btn-danger","remove",3,"click"],[1,"fa","fa-trash"],[3,"data","settings"],[1,"alert","alert-danger","text-center","mt-3",2,"margin-top","4rem"],[1,"no-record"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"nb-card",0),s["\u0275\u0275elementStart"](1,"nb-card-header"),s["\u0275\u0275elementStart"](2,"div",1),s["\u0275\u0275elementStart"](3,"div",2),s["\u0275\u0275elementStart"](4,"h5"),s["\u0275\u0275text"](5,"Battery Inventory"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"nb-card-body"),s["\u0275\u0275elementStart"](7,"div"),s["\u0275\u0275template"](8,f,17,1,"table",3),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"div",4),s["\u0275\u0275elementStart"](10,"div",5),s["\u0275\u0275elementStart"](11,"button",6),s["\u0275\u0275listener"]("click",(function(){return t.testFilledData()})),s["\u0275\u0275text"](12,"Save"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](13,"div",7),s["\u0275\u0275elementStart"](14,"div",8),s["\u0275\u0275elementStart"](15,"select",9),s["\u0275\u0275listener"]("ngModelChange",(function(e){return t.mapped=e})),s["\u0275\u0275elementStart"](16,"option",10),s["\u0275\u0275text"](17,"All"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](18,"option",11),s["\u0275\u0275text"](19,"Mapped"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](20,"option",12),s["\u0275\u0275text"](21,"Unmapped"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](22,"div",8),s["\u0275\u0275elementStart"](23,"input",13),s["\u0275\u0275listener"]("click",(function(){return t.getDate2("start")})),s["\u0275\u0275pipe"](24,"date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](25,"div",8),s["\u0275\u0275elementStart"](26,"input",14),s["\u0275\u0275listener"]("click",(function(){return t.getDate2("end")})),s["\u0275\u0275pipe"](27,"date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](28,"div",8),s["\u0275\u0275elementStart"](29,"button",15),s["\u0275\u0275listener"]("click",(function(){return t.getBatteries()})),s["\u0275\u0275text"](30,"Search"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](31,"div",16),s["\u0275\u0275template"](32,b,1,2,"smart-table",17),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](33,S,3,0,"div",18),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("ngIf",t.inventories),s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngModel",t.mapped),s["\u0275\u0275advance"](8),s["\u0275\u0275property"]("value",s["\u0275\u0275pipeBind2"](24,6,t.startDate,"dd MMM yyyy")),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("value",s["\u0275\u0275pipeBind2"](27,9,t.endDate,"dd MMM yyyy")),s["\u0275\u0275advance"](6),s["\u0275\u0275property"]("ngIf",t.data&&t.data.length),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.data||!t.data.length))},directives:[m.s,m.v,m.r,c.u,h.D,h.r,h.u,h.w,h.G,c.t,u.a,h.d,p.a],pipes:[c.f],styles:[""]}),e})();var x=n("IAMq");let w=(()=>{class e{constructor(e,t){this.user=e,this.router=t}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](l.a),s["\u0275\u0275directiveInject"](a.c))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["ngx-pages"]],decls:3,vars:1,consts:[[3,"items"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"ngx-sample-layout"),s["\u0275\u0275element"](1,"nb-menu",0),s["\u0275\u0275element"](2,"router-outlet"),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("items",t.user._menu.battery))},directives:[x.a,m.W,a.h],encapsulation:2}),e})();var I=n("ia/1");function D(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",8),s["\u0275\u0275elementStart"](1,"auto-suggestion",17),s["\u0275\u0275listener"]("onSelected",(function(t){s["\u0275\u0275restoreView"](e);const n=s["\u0275\u0275nextContext"]().index;return s["\u0275\u0275nextContext"]().getvehicleData(t,n)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275propertyInterpolate1"]("url","Suggestion/getFoVehList?vehicleType=",e.refmode,"")}}function C(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"div",8),s["\u0275\u0275elementStart"](1,"auto-suggestion",18),s["\u0275\u0275listener"]("onSelected",(function(t){s["\u0275\u0275restoreView"](e);const n=s["\u0275\u0275nextContext"]().index;return s["\u0275\u0275nextContext"]().getWarehouseData(t,n)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}if(2&e){const e=s["\u0275\u0275nextContext"]().$implicit;s["\u0275\u0275advance"](1),s["\u0275\u0275propertyInterpolate1"]("url","Suggestion/getFoVehList?vehicleType=",e.refmode,"")}}function B(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"td"),s["\u0275\u0275elementStart"](1,"i",19),s["\u0275\u0275listener"]("click",(function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"](2).addMore()})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()}}function M(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"i",21),s["\u0275\u0275listener"]("click",(function(){s["\u0275\u0275restoreView"](e);const t=s["\u0275\u0275nextContext"](2).index;return s["\u0275\u0275nextContext"]().vehicleBattery.splice(t,1)})),s["\u0275\u0275elementEnd"]()}}function V(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"td"),s["\u0275\u0275template"](1,M,1,0,"i",20),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]().index;s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",0!==e)}}function k(e,t){if(1&e){const e=s["\u0275\u0275getCurrentView"]();s["\u0275\u0275elementStart"](0,"tr"),s["\u0275\u0275elementStart"](1,"td"),s["\u0275\u0275text"](2),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](3,"td"),s["\u0275\u0275elementStart"](4,"div",0),s["\u0275\u0275elementStart"](5,"div",8),s["\u0275\u0275elementStart"](6,"select",9),s["\u0275\u0275listener"]("ngModelChange",(function(n){return s["\u0275\u0275restoreView"](e),t.$implicit.refmode=n}))("change",(function(){return s["\u0275\u0275restoreView"](e),s["\u0275\u0275nextContext"]().resetVehDetails()})),s["\u0275\u0275elementStart"](7,"option",10),s["\u0275\u0275text"](8,"Vehicle"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](9,"option",11),s["\u0275\u0275text"](10,"Warehouse"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](11,D,2,1,"div",12),s["\u0275\u0275template"](12,C,2,1,"div",12),s["\u0275\u0275elementStart"](13,"div",8),s["\u0275\u0275elementStart"](14,"auto-suggestion",13),s["\u0275\u0275listener"]("onSelected",(function(n){s["\u0275\u0275restoreView"](e);const a=t.index;return s["\u0275\u0275nextContext"]().getBatteryDetails(n,a)})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](15,"td"),s["\u0275\u0275elementStart"](16,"input",14),s["\u0275\u0275listener"]("ngModelChange",(function(n){return s["\u0275\u0275restoreView"](e),t.$implicit.date=n}))("click",(function(){s["\u0275\u0275restoreView"](e);const n=t.index;return s["\u0275\u0275nextContext"]().getDate(n)})),s["\u0275\u0275pipe"](17,"date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](18,"td"),s["\u0275\u0275elementStart"](19,"input",15),s["\u0275\u0275listener"]("ngModelChange",(function(n){return s["\u0275\u0275restoreView"](e),t.$implicit.details=n})),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275template"](20,B,2,0,"td",16),s["\u0275\u0275template"](21,V,2,1,"td",16),s["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index;s["\u0275\u0275advance"](2),s["\u0275\u0275textInterpolate"](n+1),s["\u0275\u0275advance"](4),s["\u0275\u0275property"]("ngModel",e.refmode),s["\u0275\u0275advance"](5),s["\u0275\u0275property"]("ngIf",701==e.refmode),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",703==e.refmode),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("preSelected",null)("inputId","batteryNo-"+n),s["\u0275\u0275advance"](2),s["\u0275\u0275property"]("ngModel",e.date)("value",s["\u0275\u0275pipeBind2"](17,11,e.date,"dd MMM yyyy")),s["\u0275\u0275advance"](3),s["\u0275\u0275property"]("ngModel",e.details),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",0==n),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",0!==n)}}let F=(()=>{class e{constructor(e,t,n){this.modalService=e,this.common=t,this.api=n,this.refmode="701",this.vehicleBattery=[{refmode:"701",refid:null,batteryId:null,date:this.common.dateFormatter(new Date).split(" ")[0],details:null}],this.vehicleNo="",this.vehicleId=null,this.common.refresh=this.refresh.bind(this)}ngOnInit(){}refresh(){console.log("refresh")}getDate(e){this.common.params={ref_page:"Tyre Inputs",date:this.vehicleBattery[e].date},this.modalService.open(i.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then(t=>{this.vehicleBattery[e].date=this.common.dateFormatter(t.date).split(" ")[0],console.log("Date:",this.vehicleBattery[e].date)})}getBatteryDetails(e,t){this.vehicleBattery[t].batteryId=e.id,this.getBatteryCurrentStatus(this.vehicleBattery[t].batteryId,t)}getvehicleData(e,t){this.vehicleBattery[t].refid=e.id,this.vehicleId=e.id,console.log("refid",e)}resetVehDetails(){}addMore(){this.vehicleBattery.push({refmode:"701",refid:null,batteryId:null,date:this.common.dateFormatter(new Date).split(" ")[0],details:null})}saveDetails(){if(this.vehicleId){this.common.loading++;let e={vehicleBattery:JSON.stringify(this.vehicleBattery)};console.log("Params:",e),this.api.post("Battery/saveBatteryMappingWrtVeh",e).subscribe(e=>{this.common.loading--,console.log("return id ",e.data[0].r_id),e.data[0].r_id>0?(console.log("sucess"),this.common.showToast("sucess")):(console.log("fail"),this.common.showError(e.data[0].r_msg))},e=>{this.common.loading--,console.error(e),this.common.showError()})}else this.common.showError("Please Select Vehicle")}getBatteryCurrentStatus(e,t){if(console.log("vehicle Id ---",this.vehicleId,"battery====",e),e){let n,a="batteryId="+e;console.log("params ",a),this.api.get("Battery/getBatteryCurrentStatus?"+a).subscribe(e=>{console.log("Res: ",e.data),e.data[0].r_id>0&&(n=e.data[0].r_msg,this.openConrirmationAlert(n,t))},e=>{console.error(e),this.common.showError()})}else alert("Vehicle id and battery Id is Mandatory")}openConrirmationAlert(e,t){this.common.params={title:"Current Postion Of Battery",description:e+" Do you want to change ?"},this.modalService.open(I.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then(e=>{e.response||(this.vehicleBattery[t].batteryId=null,document.getElementById("batteryNo-"+t).value="")})}getWarehouseData(e,t){}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](d.r),s["\u0275\u0275directiveInject"](r.a),s["\u0275\u0275directiveInject"](o.a))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["vehicle-battery"]],decls:25,vars:1,consts:[[1,"row"],[1,"col-sm-5"],[2,"padding","10px 15px"],[1,"table","table-bordered"],[1,"thead"],[4,"ngFor","ngForOf"],[1,"submit_button"],["type","button","outline","","id","saveDetails",1,"btn","btn-primary",2,"cursor","pointer","margin-top","10px",3,"click"],[1,"col-sm-4"],["required","",1,"form-control",3,"ngModel","ngModelChange","change"],["value","701"],["value","703"],["class","col-sm-4",4,"ngIf"],["url","Battery/getBatteryNumbersAccordingFO","display","batterynum","placeholder","Battery No",3,"preSelected","inputId","onSelected"],["type","text","autocomplete","off","placeholder","Select Date","name","date","readonly","",1,"form-control",2,"cursor","pointer",3,"ngModel","value","ngModelChange","click"],["type","text","placeholder","Details",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],["display","regno","placeholder","Enter Vehicle Number",2,"width","60%",3,"url","onSelected"],["display","regno","placeholder","Enter WareHouse",2,"width","60%",3,"url","onSelected"],[1,"fa","fa-plus","add",3,"click"],["class","fa fa-trash remove",3,"click",4,"ngIf"],[1,"fa","fa-trash","remove",3,"click"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"nb-card"),s["\u0275\u0275elementStart"](1,"nb-card-header"),s["\u0275\u0275elementStart"](2,"div",0),s["\u0275\u0275elementStart"](3,"div",1),s["\u0275\u0275elementStart"](4,"h5"),s["\u0275\u0275text"](5,"Vehicle Battery"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"nb-card-body",2),s["\u0275\u0275elementStart"](7,"table",3),s["\u0275\u0275elementStart"](8,"thead",4),s["\u0275\u0275elementStart"](9,"tr"),s["\u0275\u0275elementStart"](10,"th"),s["\u0275\u0275text"](11,"#"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](12,"th"),s["\u0275\u0275text"](13,"Battery Details"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](14,"th"),s["\u0275\u0275text"](15,"Date"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](16,"th"),s["\u0275\u0275text"](17,"Details"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](18,"th"),s["\u0275\u0275text"](19,"Action"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](20,"tbody"),s["\u0275\u0275template"](21,k,22,14,"tr",5),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](22,"div",6),s["\u0275\u0275elementStart"](23,"button",7),s["\u0275\u0275listener"]("click",(function(){return t.saveDetails()})),s["\u0275\u0275text"](24,"Save"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](21),s["\u0275\u0275property"]("ngForOf",t.vehicleBattery))},directives:[m.s,m.v,m.r,c.t,h.D,h.C,h.r,h.u,h.w,h.G,c.u,u.a,h.d],pipes:[c.f],styles:[""]}),e})();var N=n("86iY");function j(e,t){if(1&e&&(s["\u0275\u0275elementStart"](0,"div",6),s["\u0275\u0275element"](1,"smart-table",7),s["\u0275\u0275elementEnd"]()),2&e){const e=s["\u0275\u0275nextContext"]();s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("data",e.table.data)("settings",e.table.settings)}}function T(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"div",8),s["\u0275\u0275elementStart"](1,"h4",9),s["\u0275\u0275text"](2,"No Record Found"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]())}let _=(()=>{class e{constructor(e,t,n){this.api=e,this.common=t,this.modalService=n,this.data=[],this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={},this.common.refresh=this.refresh.bind(this),this.getBetterySummary()}ngOnInit(){}refresh(){this.data=[],this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={},this.getBetterySummary()}getBetterySummary(){this.common.loading++,this.api.get("Battery/getBatterySummary").subscribe(e=>{if(this.common.loading--,this.data=JSON.parse(e.data),this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={},!this.data||!this.data.length)return;let t=this.data[0];for(var n in t)if("_"!=n.charAt(0)){this.headings.push(n);let e={title:this.formatTitle(n),placeholder:this.formatTitle(n)};this.table.data.headings[n]=e}this.table.data.columns=this.getTableColumns()},e=>{this.common.loading--,console.log(e)})}formatTitle(e){return e.charAt(0).toUpperCase()+e.slice(1)}getTableColumns(){let e=[];return console.log("Data=",this.data),this.data.map(t=>{this.valobj={};for(let e=0;e<this.headings.length;e++)console.log("doc index value:",t[this.headings[e]]),this.valobj[this.headings[e]]="Action"==this.headings[e]?{value:t[this.headings[e]],class:"blue",action:this.openBatterySummary.bind(this,t,"site")}:{value:t[this.headings[e]],class:"black",action:""};e.push(this.valobj)}),e}openBatterySummary(e){console.log("Battery summary Modal",e),this.common.params={vehicle:{id:e._vid,regno:e.Vehicle,refMode:e._refmode},ref_page:"battery-summary"},this.modalService.open(N.a,{size:"lg",container:"nb-layout",backdrop:"static"}).result.then(e=>{})}}return e.\u0275fac=function(t){return new(t||e)(s["\u0275\u0275directiveInject"](o.a),s["\u0275\u0275directiveInject"](r.a),s["\u0275\u0275directiveInject"](d.r))},e.\u0275cmp=s["\u0275\u0275defineComponent"]({type:e,selectors:[["battery-summary"]],decls:9,vars:2,consts:[[2,"margin","0px","padding-top","0px","border","0px","height","100%"],[1,"row"],[1,"col-sm-8"],[2,"padding-bottom","0px","height","calc(100vh - 80px)"],["class","mt-3",4,"ngIf"],["class","alert alert-danger text-center mt-3",4,"ngIf"],[1,"mt-3"],[3,"data","settings"],[1,"alert","alert-danger","text-center","mt-3"],[1,"no-record"]],template:function(e,t){1&e&&(s["\u0275\u0275elementStart"](0,"nb-card",0),s["\u0275\u0275elementStart"](1,"nb-card-header"),s["\u0275\u0275elementStart"](2,"div",1),s["\u0275\u0275elementStart"](3,"div",2),s["\u0275\u0275elementStart"](4,"h5"),s["\u0275\u0275text"](5,"Battery Summary"),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementStart"](6,"nb-card-body",3),s["\u0275\u0275template"](7,j,2,2,"div",4),s["\u0275\u0275template"](8,T,3,0,"div",5),s["\u0275\u0275elementEnd"](),s["\u0275\u0275elementEnd"]()),2&e&&(s["\u0275\u0275advance"](7),s["\u0275\u0275property"]("ngIf",t.data&&t.data.length),s["\u0275\u0275advance"](1),s["\u0275\u0275property"]("ngIf",!t.data||!t.data.length))},directives:[m.s,m.v,m.r,c.u,p.a],styles:["[_nghost-%COMP%]    .blue{color:#00f;font-weight:700}"]}),e})();var A=n("UTcu"),O=n("mNmA");const z=[{path:"",component:w,children:[{path:"battery-inventory",component:E,canActivate:[A.a,O.b]},{path:"vehicle-battery",component:F,canActivate:[A.a,O.b]},{path:"battery-summary",component:_,canActivate:[A.a,O.b]}]}];let W=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.g.forChild(z)],a.g]}),e})();var $=n("vTDv"),H=n("FUS3"),J=n("i+lE");let P=(()=>{class e{}return e.\u0275mod=s["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=s["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[W,$.a,H.a,J.c,J.e]]}),e})()}}]);