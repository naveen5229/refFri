!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function n(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{Kkpf:function(t,a,r){"use strict";r.r(a),r.d(a,"BatteryModule",(function(){return X}));var o=r("iInd"),i=r("OlR4"),l=r("H+bZ"),s=r("Xy1B"),d=r("qfBg"),c=r("8Y7J"),m=r("G0yt"),u=r("tKwJ"),h=r("SVse"),p=r("s7LF"),v=r("0zba"),g=r("wD9S");function f(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"td"),c["\u0275\u0275elementStart"](1,"button",31),c["\u0275\u0275listener"]("click",(function(){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"](3).addMore()})),c["\u0275\u0275element"](2,"i",32),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}}function y(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"td"),c["\u0275\u0275elementStart"](1,"button",33),c["\u0275\u0275listener"]("click",(function(){c["\u0275\u0275restoreView"](n);var e=c["\u0275\u0275nextContext"]().index;return c["\u0275\u0275nextContext"](2).inventories.splice(e,1)})),c["\u0275\u0275element"](2,"i",34),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}}function b(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"tr"),c["\u0275\u0275elementStart"](1,"td"),c["\u0275\u0275text"](2),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](3,"td",23),c["\u0275\u0275elementStart"](4,"auto-suggestion",24),c["\u0275\u0275listener"]("onSelected",(function(e){c["\u0275\u0275restoreView"](n);var a=t.index;return c["\u0275\u0275nextContext"](2).selectModel(e,a)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"td",25),c["\u0275\u0275elementStart"](6,"input",26),c["\u0275\u0275listener"]("ngModelChange",(function(e){return c["\u0275\u0275restoreView"](n),t.$implicit.batteryNo=e}))("focus",(function(){c["\u0275\u0275restoreView"](n);var e=t.index;return c["\u0275\u0275nextContext"](2).size(e)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](7,"td",27),c["\u0275\u0275elementStart"](8,"input",28),c["\u0275\u0275listener"]("ngModelChange",(function(e){return c["\u0275\u0275restoreView"](n),t.$implicit.months=e})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"td",27),c["\u0275\u0275elementStart"](10,"input",29),c["\u0275\u0275listener"]("click",(function(){c["\u0275\u0275restoreView"](n);var e=t.index;return c["\u0275\u0275nextContext"](2).getDate(e)})),c["\u0275\u0275pipe"](11,"date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](12,f,3,0,"td",30),c["\u0275\u0275template"](13,y,3,0,"td",30),c["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit,r=t.index;c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate"](r+1),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("inputId","modelNo_"+r),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngModel",a.batteryNo),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngModel",a.months),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("value",c["\u0275\u0275pipeBind2"](11,7,a.buydate,"dd MMM yyyy")),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngIf",0==r),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",0!==r)}}function S(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"table",19),c["\u0275\u0275elementStart"](1,"thead",20),c["\u0275\u0275elementStart"](2,"tr",21),c["\u0275\u0275elementStart"](3,"th"),c["\u0275\u0275text"](4,"# "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](5,"th"),c["\u0275\u0275text"](6,"Battery Model"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](7,"th"),c["\u0275\u0275text"](8,"Battery No"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"th"),c["\u0275\u0275text"](10,"Warrenty Month "),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](11,"th"),c["\u0275\u0275text"](12,"Purchase Date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](13,"th"),c["\u0275\u0275text"](14,"\xa0"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](15,"tbody"),c["\u0275\u0275template"](16,b,14,10,"tr",22),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e){var n=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](16),c["\u0275\u0275property"]("ngForOf",n.inventories)}}function E(e,t){if(1&e&&c["\u0275\u0275element"](0,"smart-table",35),2&e){var n=c["\u0275\u0275nextContext"]();c["\u0275\u0275property"]("data",n.table.data)("settings",n.table.settings)}}function x(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",36),c["\u0275\u0275elementStart"](1,"h4",37),c["\u0275\u0275text"](2,"No Record Found"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]())}var w,I,D=((w=function(){function t(n,a,r,o){var i;e(this,t),this.modalService=n,this.common=a,this.api=r,this.user=o,this.csv=null,this.startDate="",this.endDate="",this.mapped=-1,this.data=[],this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={},this.inventories=[{modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)},{modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)},{modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)}],this.activeRow=-1,this.modelSuggestion=!1,this.models=[],this.sizeSuggestion=[],this.userType=null,console.log("user",o._loggedInBy),this.userType=this.common.user._loggedInBy,i=new Date,this.endDate=this.common.dateFormatter(i),this.startDate=this.common.dateFormatter(new Date(i.setDate(i.getDate()-7))),console.log("dates ",this.endDate,this.startDate),this.getBatteries(),this.common.refresh=this.refresh.bind(this)}return n(t,[{key:"ngOnInit",value:function(){}},{key:"refresh",value:function(){this.getBatteries()}},{key:"searchModels",value:function(e,t){var n=this;this.modelSuggestion=!0;var a="search="+e+"&typeId=-2";console.log("params",a),this.activeRow=t,e.length>2&&setTimeout((function(){console.log("length=",e.length),console.log("parmas",a),n.api.get("Suggestion/getBatteryNamesWithBrands?"+a).subscribe((function(e){n.models=e.data,console.log("suggestions",n.models)}),(function(e){console.error(e),n.common.showError()}))}),3e3)}},{key:"selectModel",value:function(e,t){console.log("model",e),this.inventories[t].modelId=""+e.item_id,this.inventories[t].months=e.max_limit,this.modelSuggestion=!1}},{key:"testFilledData",value:function(){for(var e=this.inventories.length,t=[],n=0;n<e;n++){if(console.log("batteryno.",this.inventories[n].batteryNo),null==this.inventories[n].batteryNo&&null!=this.inventories[n].modelId)return void this.common.showToast("fill battery number to continue");if(null!=this.inventories[n].batteryNo&&null!=this.inventories[n].modelId){if(this.inventories[n].months&&this.inventories[n].months>99)return void this.common.showToast("warrenty month can not be exceeded 99");t.push(this.inventories[n])}}console.log("inv",t),this.inventories=t;for(var a=0;a<this.inventories.length;a++)this.inventories[a].buydate=this.common.dateFormatter(new Date(this.inventories[a].buydate)).split(" ")[0];this.saveDetails()}},{key:"getDate",value:function(e){var t=this;this.common.params={ref_page:"Inventory"},this.modalService.open(s.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then((function(n){t.inventories[e].buydate=t.common.dateFormatter(n.date).split(" ")[0],console.log("Date:",t.inventories[e].buydate)}))}},{key:"size",value:function(e){console.log("size-"+e),this.inventories[e].batteryNo=document.getElementById("size-"+e).value}},{key:"saveDetails",value:function(){var e=this;console.log("inventories",this.inventories),this.common.loading++;var t={batterydetails:JSON.stringify(this.inventories)};console.log("Params:",t),this.api.post("Battery/saveBatteryInventory",t).subscribe((function(t){e.common.loading--,console.log("return id ",t.data[0].r_id),t.data[0].r_id>0?e.common.showToast("sucess"):(e.common.showError(t.data[0].r_msg),e.addMore())}),(function(t){e.common.loading--,console.error(t),e.common.showError()}))}},{key:"getDate2",value:function(e){var t=this;this.common.params={ref_page:"LrView"},this.modalService.open(s.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then((function(n){if(n.date){if("start"==e)return t.startDate="",t.startDate=t.common.dateFormatter1(n.date).split(" ")[0];t.endDate=t.common.dateFormatter1(n.date).split(" ")[0],console.log("endDate",t.endDate)}}))}},{key:"getBatteries",value:function(){var e=this,t=new Date(this.common.dateFormatter1(this.endDate).split(" ")[0]),n={startDate:this.common.dateFormatter1(this.startDate).split(" ")[0],endDate:this.common.dateFormatter1(t.setDate(t.getDate()+1)).split(" ")[0],mapped:this.mapped};++this.common.loading,this.api.post("Battery/getBatteryInventory",n).subscribe((function(t){--e.common.loading,e.data=t.data,e.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},e.headings=[],e.valobj={};var n=e.data[0];for(var a in n)if("_"!=a.charAt(0)){e.headings.push(a);var r={title:e.formatTitle(a),placeholder:e.formatTitle(a)};e.table.data.headings[a]=r}e.table.data.columns=e.getTableColumns()}),(function(t){--e.common.loading,console.log("Err:",t)}))}},{key:"formatTitle",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},{key:"getTableColumns",value:function(){var e=this,t=[];return console.log("Data=",this.data),this.data.map((function(n){e.valobj={};for(var a=0;a<e.headings.length;a++)e.valobj[e.headings[a]]={value:n[e.headings[a]],class:"black",action:""};t.push(e.valobj)})),t}},{key:"addMore",value:function(){this.inventories.push({modelId:null,months:null,batteryNo:null,buydate:this.common.dateFormatter(new Date)})}},{key:"remove",value:function(){this.inventories.pop()}},{key:"handleFileSelection",value:function(e){var t=this;this.common.loading++,this.common.getBase64(e.target.files[0]).then((function(n){if(t.common.loading--,"text/csv"!=e.target.files[0].type)return alert("valid Format Are : CSV"),!1;n=n.toString().replace("vnd.ms-excel","csv"),console.log("Base 64: ",n),t.csv=n}),(function(e){t.common.loading--,console.error("Base Err: ",e)}))}},{key:"importCsv",value:function(){var e=this,t={inventoryCsv:this.csv};if(!t.inventoryCsv)return this.common.showError("Select csv");console.log("Data :",t),this.common.loading++,this.api.post("Tyres/importTyreInventoryCsv ",t).subscribe((function(t){e.common.loading--,console.log("upload result",t),console.log("error: ",t.data.f),alert(t.msg)}),(function(t){e.common.loading--,console.log(t)}))}}]),t}()).\u0275fac=function(e){return new(e||w)(c["\u0275\u0275directiveInject"](m.r),c["\u0275\u0275directiveInject"](i.a),c["\u0275\u0275directiveInject"](l.a),c["\u0275\u0275directiveInject"](d.a))},w.\u0275cmp=c["\u0275\u0275defineComponent"]({type:w,selectors:[["battery-inventory"]],decls:34,vars:12,consts:[[2,"border","0px"],[1,"row"],[1,"col-sm-8"],["class","table table-bordered table-hover",4,"ngIf"],[1,"row-width","clearfix"],[1,"text-left"],["type","button","outline","","id","saveDetails",1,"btn","btn-primary",2,"cursor","pointer",3,"click"],[1,"row","mt-3"],[1,"col-sm-3"],[1,"form","Control",3,"ngModel","ngModelChange"],["value","-1"],["value","1"],["value","0"],["type","text","name","date","placeholder","Start Date",1,"form-control",3,"value","click"],["type","text","name","date1","placeholder","End Date",1,"form-control",3,"value","click"],[1,"btn","btn-primary",3,"click"],[1,"mt-3"],[3,"data","settings",4,"ngIf"],["class","alert alert-danger text-center mt-3","style","margin-top:4rem",4,"ngIf"],[1,"table","table-bordered","table-hover"],[1,"thead"],[2,"text-align","center"],[4,"ngFor","ngForOf"],["width","35%"],["url","Suggestion/getBatteryNamesWithBrands?typeId=-2","display","modelname","placeholder","Model No",3,"inputId","onSelected"],["width","15%"],["id","battNo","name","battNo","type","text","placeholder","Enter battery number","autocomplete","off",1,"form-control",3,"ngModel","ngModelChange","focus"],["width","20%"],["type","text","autocomplete","off","placeholder","Warrenty Month","name","date",1,"form-control",2,"cursor","pointer",3,"ngModel","ngModelChange"],["type","text","autocomplete","off","placeholder","Select Date","name","date","readonly","",1,"form-control",2,"cursor","pointer",3,"value","click"],[4,"ngIf"],[1,"btn","btn-primary","add",3,"click"],[1,"fa","fa-plus"],[1,"btn","btn-danger","remove",3,"click"],[1,"fa","fa-trash"],[3,"data","settings"],[1,"alert","alert-danger","text-center","mt-3",2,"margin-top","4rem"],[1,"no-record"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"nb-card",0),c["\u0275\u0275elementStart"](1,"nb-card-header"),c["\u0275\u0275elementStart"](2,"div",1),c["\u0275\u0275elementStart"](3,"div",2),c["\u0275\u0275elementStart"](4,"h5"),c["\u0275\u0275text"](5,"Battery Inventory"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"nb-card-body"),c["\u0275\u0275elementStart"](7,"div"),c["\u0275\u0275template"](8,S,17,1,"table",3),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"div",4),c["\u0275\u0275elementStart"](10,"div",5),c["\u0275\u0275elementStart"](11,"button",6),c["\u0275\u0275listener"]("click",(function(){return t.testFilledData()})),c["\u0275\u0275text"](12,"Save"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](13,"div",7),c["\u0275\u0275elementStart"](14,"div",8),c["\u0275\u0275elementStart"](15,"select",9),c["\u0275\u0275listener"]("ngModelChange",(function(e){return t.mapped=e})),c["\u0275\u0275elementStart"](16,"option",10),c["\u0275\u0275text"](17,"All"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](18,"option",11),c["\u0275\u0275text"](19,"Mapped"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](20,"option",12),c["\u0275\u0275text"](21,"Unmapped"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](22,"div",8),c["\u0275\u0275elementStart"](23,"input",13),c["\u0275\u0275listener"]("click",(function(){return t.getDate2("start")})),c["\u0275\u0275pipe"](24,"date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](25,"div",8),c["\u0275\u0275elementStart"](26,"input",14),c["\u0275\u0275listener"]("click",(function(){return t.getDate2("end")})),c["\u0275\u0275pipe"](27,"date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](28,"div",8),c["\u0275\u0275elementStart"](29,"button",15),c["\u0275\u0275listener"]("click",(function(){return t.getBatteries()})),c["\u0275\u0275text"](30,"Search"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](31,"div",16),c["\u0275\u0275template"](32,E,1,2,"smart-table",17),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](33,x,3,0,"div",18),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](8),c["\u0275\u0275property"]("ngIf",t.inventories),c["\u0275\u0275advance"](7),c["\u0275\u0275property"]("ngModel",t.mapped),c["\u0275\u0275advance"](8),c["\u0275\u0275property"]("value",c["\u0275\u0275pipeBind2"](24,6,t.startDate,"dd MMM yyyy")),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("value",c["\u0275\u0275pipeBind2"](27,9,t.endDate,"dd MMM yyyy")),c["\u0275\u0275advance"](6),c["\u0275\u0275property"]("ngIf",t.data&&t.data.length),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",!t.data||!t.data.length))},directives:[u.s,u.v,u.r,h.u,p.D,p.r,p.u,p.w,p.G,h.t,v.a,p.d,g.a],pipes:[h.f],styles:[""]}),w),C=r("IAMq"),k=((I=function t(n,a){e(this,t),this.user=n,this.router=a}).\u0275fac=function(e){return new(e||I)(c["\u0275\u0275directiveInject"](d.a),c["\u0275\u0275directiveInject"](o.c))},I.\u0275cmp=c["\u0275\u0275defineComponent"]({type:I,selectors:[["ngx-pages"]],decls:3,vars:1,consts:[[3,"items"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"ngx-sample-layout"),c["\u0275\u0275element"](1,"nb-menu",0),c["\u0275\u0275element"](2,"router-outlet"),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("items",t.user._menu.battery))},directives:[C.a,u.W,o.h],encapsulation:2}),I),B=r("ia/1");function M(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div",8),c["\u0275\u0275elementStart"](1,"auto-suggestion",17),c["\u0275\u0275listener"]("onSelected",(function(e){c["\u0275\u0275restoreView"](n);var t=c["\u0275\u0275nextContext"]().index;return c["\u0275\u0275nextContext"]().getvehicleData(e,t)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){var a=c["\u0275\u0275nextContext"]().$implicit;c["\u0275\u0275advance"](1),c["\u0275\u0275propertyInterpolate1"]("url","Suggestion/getFoVehList?vehicleType=",a.refmode,"")}}function V(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"div",8),c["\u0275\u0275elementStart"](1,"auto-suggestion",18),c["\u0275\u0275listener"]("onSelected",(function(e){c["\u0275\u0275restoreView"](n);var t=c["\u0275\u0275nextContext"]().index;return c["\u0275\u0275nextContext"]().getWarehouseData(e,t)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}if(2&e){var a=c["\u0275\u0275nextContext"]().$implicit;c["\u0275\u0275advance"](1),c["\u0275\u0275propertyInterpolate1"]("url","Suggestion/getFoVehList?vehicleType=",a.refmode,"")}}function F(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"td"),c["\u0275\u0275elementStart"](1,"i",19),c["\u0275\u0275listener"]("click",(function(){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"](2).addMore()})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()}}function N(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"i",21),c["\u0275\u0275listener"]("click",(function(){c["\u0275\u0275restoreView"](n);var e=c["\u0275\u0275nextContext"](2).index;return c["\u0275\u0275nextContext"]().vehicleBattery.splice(e,1)})),c["\u0275\u0275elementEnd"]()}}function j(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"td"),c["\u0275\u0275template"](1,N,1,0,"i",20),c["\u0275\u0275elementEnd"]()),2&e){var n=c["\u0275\u0275nextContext"]().index;c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",0!==n)}}function T(e,t){if(1&e){var n=c["\u0275\u0275getCurrentView"]();c["\u0275\u0275elementStart"](0,"tr"),c["\u0275\u0275elementStart"](1,"td"),c["\u0275\u0275text"](2),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](3,"td"),c["\u0275\u0275elementStart"](4,"div",0),c["\u0275\u0275elementStart"](5,"div",8),c["\u0275\u0275elementStart"](6,"select",9),c["\u0275\u0275listener"]("ngModelChange",(function(e){return c["\u0275\u0275restoreView"](n),t.$implicit.refmode=e}))("change",(function(){return c["\u0275\u0275restoreView"](n),c["\u0275\u0275nextContext"]().resetVehDetails()})),c["\u0275\u0275elementStart"](7,"option",10),c["\u0275\u0275text"](8,"Vehicle"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](9,"option",11),c["\u0275\u0275text"](10,"Warehouse"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](11,M,2,1,"div",12),c["\u0275\u0275template"](12,V,2,1,"div",12),c["\u0275\u0275elementStart"](13,"div",8),c["\u0275\u0275elementStart"](14,"auto-suggestion",13),c["\u0275\u0275listener"]("onSelected",(function(e){c["\u0275\u0275restoreView"](n);var a=t.index;return c["\u0275\u0275nextContext"]().getBatteryDetails(e,a)})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](15,"td"),c["\u0275\u0275elementStart"](16,"input",14),c["\u0275\u0275listener"]("ngModelChange",(function(e){return c["\u0275\u0275restoreView"](n),t.$implicit.date=e}))("click",(function(){c["\u0275\u0275restoreView"](n);var e=t.index;return c["\u0275\u0275nextContext"]().getDate(e)})),c["\u0275\u0275pipe"](17,"date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](18,"td"),c["\u0275\u0275elementStart"](19,"input",15),c["\u0275\u0275listener"]("ngModelChange",(function(e){return c["\u0275\u0275restoreView"](n),t.$implicit.details=e})),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275template"](20,F,2,0,"td",16),c["\u0275\u0275template"](21,j,2,1,"td",16),c["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit,r=t.index;c["\u0275\u0275advance"](2),c["\u0275\u0275textInterpolate"](r+1),c["\u0275\u0275advance"](4),c["\u0275\u0275property"]("ngModel",a.refmode),c["\u0275\u0275advance"](5),c["\u0275\u0275property"]("ngIf",701==a.refmode),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",703==a.refmode),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("preSelected",null)("inputId","batteryNo-"+r),c["\u0275\u0275advance"](2),c["\u0275\u0275property"]("ngModel",a.date)("value",c["\u0275\u0275pipeBind2"](17,11,a.date,"dd MMM yyyy")),c["\u0275\u0275advance"](3),c["\u0275\u0275property"]("ngModel",a.details),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",0==r),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",0!==r)}}var _,A=((_=function(){function t(n,a,r){e(this,t),this.modalService=n,this.common=a,this.api=r,this.refmode="701",this.vehicleBattery=[{refmode:"701",refid:null,batteryId:null,date:this.common.dateFormatter(new Date).split(" ")[0],details:null}],this.vehicleNo="",this.vehicleId=null,this.common.refresh=this.refresh.bind(this)}return n(t,[{key:"ngOnInit",value:function(){}},{key:"refresh",value:function(){console.log("refresh")}},{key:"getDate",value:function(e){var t=this;this.common.params={ref_page:"Tyre Inputs",date:this.vehicleBattery[e].date},this.modalService.open(s.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then((function(n){t.vehicleBattery[e].date=t.common.dateFormatter(n.date).split(" ")[0],console.log("Date:",t.vehicleBattery[e].date)}))}},{key:"getBatteryDetails",value:function(e,t){this.vehicleBattery[t].batteryId=e.id,this.getBatteryCurrentStatus(this.vehicleBattery[t].batteryId,t)}},{key:"getvehicleData",value:function(e,t){this.vehicleBattery[t].refid=e.id,this.vehicleId=e.id,console.log("refid",e)}},{key:"resetVehDetails",value:function(){}},{key:"addMore",value:function(){this.vehicleBattery.push({refmode:"701",refid:null,batteryId:null,date:this.common.dateFormatter(new Date).split(" ")[0],details:null})}},{key:"saveDetails",value:function(){var e=this;if(this.vehicleId){this.common.loading++;var t={vehicleBattery:JSON.stringify(this.vehicleBattery)};console.log("Params:",t),this.api.post("Battery/saveBatteryMappingWrtVeh",t).subscribe((function(t){e.common.loading--,console.log("return id ",t.data[0].r_id),t.data[0].r_id>0?(console.log("sucess"),e.common.showToast("sucess")):(console.log("fail"),e.common.showError(t.data[0].r_msg))}),(function(t){e.common.loading--,console.error(t),e.common.showError()}))}else this.common.showError("Please Select Vehicle")}},{key:"getBatteryCurrentStatus",value:function(e,t){var n=this;if(console.log("vehicle Id ---",this.vehicleId,"battery====",e),e){var a,r="batteryId="+e;console.log("params ",r),this.api.get("Battery/getBatteryCurrentStatus?"+r).subscribe((function(e){console.log("Res: ",e.data),e.data[0].r_id>0&&(a=e.data[0].r_msg,n.openConrirmationAlert(a,t))}),(function(e){console.error(e),n.common.showError()}))}else alert("Vehicle id and battery Id is Mandatory")}},{key:"openConrirmationAlert",value:function(e,t){var n=this;this.common.params={title:"Current Postion Of Battery",description:e+" Do you want to change ?"},this.modalService.open(B.a,{size:"sm",container:"nb-layout",backdrop:"static"}).result.then((function(e){e.response||(n.vehicleBattery[t].batteryId=null,document.getElementById("batteryNo-"+t).value="")}))}},{key:"getWarehouseData",value:function(e,t){}}]),t}()).\u0275fac=function(e){return new(e||_)(c["\u0275\u0275directiveInject"](m.r),c["\u0275\u0275directiveInject"](i.a),c["\u0275\u0275directiveInject"](l.a))},_.\u0275cmp=c["\u0275\u0275defineComponent"]({type:_,selectors:[["vehicle-battery"]],decls:25,vars:1,consts:[[1,"row"],[1,"col-sm-5"],[2,"padding","10px 15px"],[1,"table","table-bordered"],[1,"thead"],[4,"ngFor","ngForOf"],[1,"submit_button"],["type","button","outline","","id","saveDetails",1,"btn","btn-primary",2,"cursor","pointer","margin-top","10px",3,"click"],[1,"col-sm-4"],["required","",1,"form-control",3,"ngModel","ngModelChange","change"],["value","701"],["value","703"],["class","col-sm-4",4,"ngIf"],["url","Battery/getBatteryNumbersAccordingFO","display","batterynum","placeholder","Battery No",3,"preSelected","inputId","onSelected"],["type","text","autocomplete","off","placeholder","Select Date","name","date","readonly","",1,"form-control",2,"cursor","pointer",3,"ngModel","value","ngModelChange","click"],["type","text","placeholder","Details",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf"],["display","regno","placeholder","Enter Vehicle Number",2,"width","60%",3,"url","onSelected"],["display","regno","placeholder","Enter WareHouse",2,"width","60%",3,"url","onSelected"],[1,"fa","fa-plus","add",3,"click"],["class","fa fa-trash remove",3,"click",4,"ngIf"],[1,"fa","fa-trash","remove",3,"click"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"nb-card"),c["\u0275\u0275elementStart"](1,"nb-card-header"),c["\u0275\u0275elementStart"](2,"div",0),c["\u0275\u0275elementStart"](3,"div",1),c["\u0275\u0275elementStart"](4,"h5"),c["\u0275\u0275text"](5,"Vehicle Battery"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"nb-card-body",2),c["\u0275\u0275elementStart"](7,"table",3),c["\u0275\u0275elementStart"](8,"thead",4),c["\u0275\u0275elementStart"](9,"tr"),c["\u0275\u0275elementStart"](10,"th"),c["\u0275\u0275text"](11,"#"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](12,"th"),c["\u0275\u0275text"](13,"Battery Details"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](14,"th"),c["\u0275\u0275text"](15,"Date"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](16,"th"),c["\u0275\u0275text"](17,"Details"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](18,"th"),c["\u0275\u0275text"](19,"Action"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](20,"tbody"),c["\u0275\u0275template"](21,T,22,14,"tr",5),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](22,"div",6),c["\u0275\u0275elementStart"](23,"button",7),c["\u0275\u0275listener"]("click",(function(){return t.saveDetails()})),c["\u0275\u0275text"](24,"Save"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](21),c["\u0275\u0275property"]("ngForOf",t.vehicleBattery))},directives:[u.s,u.v,u.r,h.t,p.D,p.C,p.r,p.u,p.w,p.G,h.u,v.a,p.d],pipes:[h.f],styles:[""]}),_),O=r("86iY");function z(e,t){if(1&e&&(c["\u0275\u0275elementStart"](0,"div",6),c["\u0275\u0275element"](1,"smart-table",7),c["\u0275\u0275elementEnd"]()),2&e){var n=c["\u0275\u0275nextContext"]();c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("data",n.table.data)("settings",n.table.settings)}}function W(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"div",8),c["\u0275\u0275elementStart"](1,"h4",9),c["\u0275\u0275text"](2,"No Record Found"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]())}var $,H,J,P=(($=function(){function t(n,a,r){e(this,t),this.api=n,this.common=a,this.modalService=r,this.data=[],this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={},this.common.refresh=this.refresh.bind(this),this.getBetterySummary()}return n(t,[{key:"ngOnInit",value:function(){}},{key:"refresh",value:function(){this.data=[],this.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},this.headings=[],this.valobj={},this.getBetterySummary()}},{key:"getBetterySummary",value:function(){var e=this;this.common.loading++,this.api.get("Battery/getBatterySummary").subscribe((function(t){if(e.common.loading--,e.data=JSON.parse(t.data),e.table={data:{headings:{},columns:[]},settings:{hideHeader:!0}},e.headings=[],e.valobj={},e.data&&e.data.length){var n=e.data[0];for(var a in n)if("_"!=a.charAt(0)){e.headings.push(a);var r={title:e.formatTitle(a),placeholder:e.formatTitle(a)};e.table.data.headings[a]=r}e.table.data.columns=e.getTableColumns()}}),(function(t){e.common.loading--,console.log(t)}))}},{key:"formatTitle",value:function(e){return e.charAt(0).toUpperCase()+e.slice(1)}},{key:"getTableColumns",value:function(){var e=this,t=[];return console.log("Data=",this.data),this.data.map((function(n){e.valobj={};for(var a=0;a<e.headings.length;a++)console.log("doc index value:",n[e.headings[a]]),e.valobj[e.headings[a]]="Action"==e.headings[a]?{value:n[e.headings[a]],class:"blue",action:e.openBatterySummary.bind(e,n,"site")}:{value:n[e.headings[a]],class:"black",action:""};t.push(e.valobj)})),t}},{key:"openBatterySummary",value:function(e){console.log("Battery summary Modal",e),this.common.params={vehicle:{id:e._vid,regno:e.Vehicle,refMode:e._refmode},ref_page:"battery-summary"},this.modalService.open(O.a,{size:"lg",container:"nb-layout",backdrop:"static"}).result.then((function(e){}))}}]),t}()).\u0275fac=function(e){return new(e||$)(c["\u0275\u0275directiveInject"](l.a),c["\u0275\u0275directiveInject"](i.a),c["\u0275\u0275directiveInject"](m.r))},$.\u0275cmp=c["\u0275\u0275defineComponent"]({type:$,selectors:[["battery-summary"]],decls:9,vars:2,consts:[[2,"margin","0px","padding-top","0px","border","0px","height","100%"],[1,"row"],[1,"col-sm-8"],[2,"padding-bottom","0px","height","calc(100vh - 80px)"],["class","mt-3",4,"ngIf"],["class","alert alert-danger text-center mt-3",4,"ngIf"],[1,"mt-3"],[3,"data","settings"],[1,"alert","alert-danger","text-center","mt-3"],[1,"no-record"]],template:function(e,t){1&e&&(c["\u0275\u0275elementStart"](0,"nb-card",0),c["\u0275\u0275elementStart"](1,"nb-card-header"),c["\u0275\u0275elementStart"](2,"div",1),c["\u0275\u0275elementStart"](3,"div",2),c["\u0275\u0275elementStart"](4,"h5"),c["\u0275\u0275text"](5,"Battery Summary"),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementStart"](6,"nb-card-body",3),c["\u0275\u0275template"](7,z,2,2,"div",4),c["\u0275\u0275template"](8,W,3,0,"div",5),c["\u0275\u0275elementEnd"](),c["\u0275\u0275elementEnd"]()),2&e&&(c["\u0275\u0275advance"](7),c["\u0275\u0275property"]("ngIf",t.data&&t.data.length),c["\u0275\u0275advance"](1),c["\u0275\u0275property"]("ngIf",!t.data||!t.data.length))},directives:[u.s,u.v,u.r,h.u,g.a],styles:["[_nghost-%COMP%]    .blue{color:#00f;font-weight:700}"]}),$),R=r("UTcu"),U=r("mNmA"),L=[{path:"",component:k,children:[{path:"battery-inventory",component:D,canActivate:[R.a,U.b]},{path:"vehicle-battery",component:A,canActivate:[R.a,U.b]},{path:"battery-summary",component:P,canActivate:[R.a,U.b]}]}],q=((H=function t(){e(this,t)}).\u0275mod=c["\u0275\u0275defineNgModule"]({type:H}),H.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(e){return new(e||H)},imports:[[o.g.forChild(L)],o.g]}),H),G=r("vTDv"),K=r("FUS3"),Y=r("i+lE"),X=((J=function t(){e(this,t)}).\u0275mod=c["\u0275\u0275defineNgModule"]({type:J}),J.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(e){return new(e||J)},imports:[[q,G.a,K.a,Y.c,Y.e]]}),J)}}])}();